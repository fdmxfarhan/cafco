extends layout

block styles
    link(rel="stylesheet", href="/css/dashboard/user-view.css")

block content
    -if(course)
        h1.title.center لیست کاربران دوره #{course.title}
    -else
        h1.title.center لیست همه کاربران
    .user-list 
        table 
            tr 
                th ردیف
                th نام و نام خانوادگی
                th شماره تلفن
                th کد ملی
                th تعداد دوره های ثبت نام شده
                th نوع حساب
            -for(var i=0; i<users.length; i++){
                tr(id="view-user#{i}")
                    td= i+1
                    td= users[i].fullname 
                        -if(isAnarestani(users[i].phone))
                            .green  (انارستانی)
                    td= users[i].phone
                    td= users[i].idNumber
                    td= users[i].course.length
                    td= users[i].role
            -}
        a.add-user 
                i.fa.fa-plus 
                | افزودن کاربر جدید
    -for(var i=0; i<users.length; i++){
        .popup-area(id="user-view-popup#{i}")
            .popup
                i.fa.fa-times.close-popup
                h1.title= users[i].fullname
                .part
                    .item 
                        i.fa.fa-phone
                        | تلفن: 
                        a.phone(href="tel:#{users[i].phone}")= users[i].phone
                    .item 
                        i.fa.fa-user
                        | کد ملی: 
                        .num= users[i].idNumber
                    .item 
                        i.fa.fa-map-marker
                        | نشانی: 
                        .num= users[i].address
                    .item 
                        i.fa.fa-book
                        | نام مدرسه: 
                        .num= users[i].school
                    .item 
                        i.fa.fa-sitemap
                        | آدرس آی پی: 
                        .num= users[i].ipAddress
                    .item 
                        i.fa.fa-book
                        | پایه تحصیلی: 
                        .num= users[i].education
                    .user-actions
                        -if(users[i].role == 'user')
                            a(href="/dashboard/make-admin?userID=#{users[i]._id}") تبدیل به ادمین
                        -else
                            a(href="/dashboard/make-user?userID=#{users[i]._id}") تبدیل به یوزر
                        a(href="/dashboard/admin-edit-user?userID=#{users[i]._id}") 
                            i.fa.fa-edit
                            | ویرایش
                        a.red(href="/dashboard/remove-user?userID=#{users[i]._id}") 
                            i.fa.fa-trash
                            | حذف کاربر 

                .part
                    h1 دوره های ثبت نام شده (#{users[i].course.length}):
                    .user-course-list-view
                        -for(var j=0; j<users[i].course.length; j++){
                            -var course = users[i].course[j].course;
                            .course 
                                img(src="#{course.cover}", alt="cover")
                                .info 
                                    h1= course.title
                                    h2 مدرس: #{course.teacher}
                                    .labels 
                                        .label.blue= course.status
                                        -if(users[i].course[j].payed)
                                            .label.green پرداخت شده
                                        -else
                                            .label.red پرداخت نشده
                                        
                        -}
                    .add-course-to-user 
                        form(action="/dashboard/admin-add-course-to-user" method="POST") 
                            select(name="courseID") 
                                -for(var j=0; j<courses.length; j++)
                                    -if(courses[j].minAge <= users[i].educationNum && courses[j].maxAge >= users[i].educationNum)
                                        option(value="#{courses[j]._id}")= courses[j].title
                            input.hidden(type="text" name="userID" value="#{users[i]._id}")
                            input.check(type="checkbox" name="payed" id="payed" value="پرداخت شده")
                            label(for="payed") پرداخت شده
                            input.submit(type="submit" value="افزودن دوره")
    -}

    .popup-area#add-user-popup
        .popup
            i.fa.fa-times.close-popup
            h1.title.center افزودن کاربر جدید
            form(action="/dashboard/admin-adduser" method="POST" autocomplete="off") 
                .part
                    .text-input-area
                        i.fa.fa-pencil
                        input.textinput(type="text" placeholder="نام" name="firstName")
                    .text-input-area
                        i.fa.fa-pencil
                        input.textinput(type="text" placeholder="نام خانوادگی" name="lastName")
                    .text-input-area
                        i.fa.fa-map-marker
                        input.textinput(type="text" placeholder="نشانی" name="address")
                    .text-input-area
                        i.fa.fa-phone
                        input.textinput(type="text" placeholder="شماره تماس (پدر یا مادر)" name="phone")
                    .text-input-area
                        i.fa.fa-book
                        input.textinput(type="text" placeholder="نام مدرسه" name="school")
                    .date-input-area
                        label(for="day") تاریخ تولد: 
                        input(type="Number" name="birthDay" placeholder="روز")
                        label(for="month") / 
                        input(type="Number" name="birthMonth" placeholder="ماه")
                        label(for="year") / 
                        input(type="Number" name="birthYear" placeholder="سال" value="1380")
                    .select-input-area
                        label(for="education") پایه تحصیلی: 
                        select(name="education") 
                            option(value="پیش دبستانی") پیش دبستانی
                            option(value="اول ابتدایی") اول ابتدایی
                            option(value="دوم ابتدایی") دوم ابتدایی
                            option(value="سوم ابتدایی") سوم ابتدایی
                            option(value="چهارم ابتدایی") چهارم ابتدایی
                            option(value="پنجم ابتدایی") پنجم ابتدایی
                            option(value="ششم ابتدایی") ششم ابتدایی
                            option(value="هفتم دوره اول دبیرستان") هفتم دوره اول دبیرستان
                            option(value="هشتم دوره اول دبیرستان") هشتم دوره اول دبیرستان
                            option(value="نهم دوره اول دبیرستان") نهم دوره اول دبیرستان
                            option(value="دهم دوره دوم دبیرستان") دهم دوره دوم دبیرستان
                            option(value="یازدهم دوره دوم دبیرستان") یازدهم دوره دوم دبیرستان
                            option(value="دوازدهم دوره دوم دبیرستان") دوازدهم دوره دوم دبیرستان
                            option(value="بزرگسال") بزرگسال
                            
                    .text-input-area
                        i.fa.fa-user
                        input.textinput(type="text" placeholder="کد ملی" name="idNumber" autocomplete="off")
                    .text-input-area
                        i.fa.fa-key
                        input.textinput(type="password" placeholder="رمز عبور" name="password" autocomplete="off")
                    .text-input-area
                        i.fa.fa-check
                        input.textinput(type="password" placeholder="تایید رمز عبور" name="configpassword" autocomplete="off")
                .part 
                    .course-checkbox-area 
                        -for(var i=0; i<courses.length; i++){
                            input(type="checkbox" name="courseList" value="#{courses[i]._id}")
                            label(for="#{courses[i]._id}") #{courses[i].title}
                                .gray-inline (#{courses[i].minAge} تا #{courses[i].maxAge})
                            br
                            
                        -}
                    button.submit(type="submit") ثبت نام
    script(src="/js/user-view.js") 