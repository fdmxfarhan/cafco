extends layout

block styles
    link(rel="stylesheet", href="/css/dashboard/user-view.css")

block content
    -if(course)
        h1.title.center لیست کاربران دوره #{course.title}
    -else
        h1.title.center لیست همه کاربران
    .user-list 
        table 
            tr 
                th ردیف
                th نام و نام خانوادگی
                th شماره تلفن
                th کد ملی
                th تعداد دوره های ثبت نام شده
                th نوع حساب
            -for(var i=0; i<users.length; i++){
                tr(id="view-user#{i}")
                    td= i+1
                    td= users[i].fullname 
                        -if(isAnarestani(users[i].phone))
                            .green  (انارستانی)
                    td= users[i].phone
                    td= users[i].idNumber
                    td= users[i].course.length
                    td= users[i].role
            -}
    -for(var i=0; i<users.length; i++){
        .popup-area(id="user-view-popup#{i}")
            .popup
                i.fa.fa-times.close-popup
                h1.title= users[i].fullname
                .part
                    .item 
                        i.fa.fa-phone
                        | تلفن: 
                        a.phone(href="tel:#{users[i].phone}")= users[i].phone
                    .item 
                        i.fa.fa-user
                        | کد ملی: 
                        .num= users[i].idNumber
                    .item 
                        i.fa.fa-map-marker
                        | نشانی: 
                        .num= users[i].address
                    .item 
                        i.fa.fa-book
                        | نام مدرسه: 
                        .num= users[i].school
                    .item 
                        i.fa.fa-sitemap
                        | آدرس آی پی: 
                        .num= users[i].ipAddress
                    .item 
                        i.fa.fa-book
                        | پایه تحصیلی: 
                        .num= users[i].education
                    .user-actions
                        -if(users[i].role == 'user')
                            a(href="/dashboard/make-admin?userID=#{users[i]._id}") تبدیل به ادمین
                        -else
                            a(href="/dashboard/make-user?userID=#{users[i]._id}") تبدیل به یوزر
                        a(href="/dashboard/admin-edit-user?userID=#{users[i]._id}") 
                            i.fa.fa-edit
                            | ویرایش
                        a.red(href="/dashboard/remove-user?userID=#{users[i]._id}") 
                            i.fa.fa-trash
                            | حذف کاربر 

                .part
                    h1 دوره های ثبت نام شده (#{users[i].course.length}):
                    .user-course-list-view
                        -for(var j=0; j<users[i].course.length; j++){
                            -var course = users[i].course[j].course;
                            .course 
                                img(src="#{course.cover}", alt="cover")
                                .info 
                                    h1= course.title
                                    h2 مدرس: #{course.teacher}
                                    .labels 
                                        .label.blue= course.status
                                        -if(users[i].course[j].payed)
                                            .label.green پرداخت شده
                                        -else
                                            .label.red پرداخت نشده
                                        
                        -}
                    .add-course-to-user 
                        form(action="/dashboard/admin-add-course-to-user" method="POST") 
                            select(name="courseID") 
                                -for(var j=0; j<courses.length; j++)
                                    -if(courses[j].minAge <= users[i].educationNum && courses[j].maxAge >= users[i].educationNum)
                                        option(value="#{courses[j]._id}")= courses[j].title
                            input.hidden(type="text" name="userID" value="#{users[i]._id}")
                            input.check(type="checkbox" name="payed" id="payed" value="پرداخت شده")
                            label(for="payed") پرداخت شده
                            input.submit(type="submit" value="افزودن دوره")
    -}
    script(src="/js/user-view.js") 